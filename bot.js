/**
 * ü§ñ Telegram Bot - –ü–∞–º—è—Ç–∫–∞ –¥–ª—è –æ–ø–µ–∫—É–Ω–æ–≤
 * –û–ª—ë–∫–º–∏–Ω—Å–∫–∏–π —Ä–∞–π–æ–Ω, –†–µ—Å–ø—É–±–ª–∏–∫–∞ –°–∞—Ö–∞ (–Ø–∫—É—Ç–∏—è)
 * 
 * –£—Å—Ç–∞–Ω–æ–≤–∫–∞: npm install node-telegram-bot-api
 * –ó–∞–ø—É—Å–∫: BOT_TOKEN=your_token node bot.js
 */

const TelegramBot = require('node-telegram-bot-api');

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
const token = process.env.BOT_TOKEN;

if (!token) {
    console.error('‚ùå –û—à–∏–±–∫–∞: –ù–µ —É–∫–∞–∑–∞–Ω BOT_TOKEN');
    console.error('–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ —Å —Ç–æ–∫–µ–Ω–æ–º: BOT_TOKEN=your_token node bot.js');
    process.exit(1);
}

// –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞ —Å polling
const bot = new TelegramBot(token, { polling: true });

// ==========================================
// –ë–ê–ó–ê –î–ê–ù–ù–´–• –ü–ê–ú–Ø–¢–ö–ò
// ==========================================

// –•—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π (–≤ –ø–∞–º—è—Ç–∏ - –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ë–î)
const reminders = new Map();

const handbookData = {
    payments: {
        title: 'üí∞ –õ—å–≥–æ—Ç—ã –∏ –≤—ã–ø–ª–∞—Ç—ã',
        federal: {
            title: 'üá∑üá∫ –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≤—ã–ø–ª–∞—Ç—ã',
            items: [
                { name: '–ï–¥–∏–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø–æ—Å–æ–±–∏–µ –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ —Ä–µ–±–µ–Ω–∫–∞', amount: '22 222 ‚ÇΩ', note: '–° 2024 –≥–æ–¥–∞' },
                { name: '–ï–∂–µ–º–µ—Å—è—á–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –Ω–∞ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ', amount: '–ü–æ —Ä–µ–≥–∏–æ–Ω—É', note: '–ó–∞–≤–∏—Å–∏—Ç –æ—Ç –º–µ—Å—Ç–∞ –∂–∏—Ç–µ–ª—å—Å—Ç–≤–∞' },
                { name: '–ü–æ—Å–æ–±–∏–µ –ø–æ —É—Ö–æ–¥—É –∑–∞ —Ä–µ–±–µ–Ω–∫–æ–º-–∏–Ω–≤–∞–ª–∏–¥–æ–º', amount: '10 000 ‚ÇΩ/–º–µ—Å', note: '–ï–∂–µ–º–µ—Å—è—á–Ω–æ' },
                { name: '–ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–π –∫–∞–ø–∏—Ç–∞–ª (1-–π —Ä–µ–±–µ–Ω–æ–∫)', amount: '630 380 ‚ÇΩ', note: '–ò–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç—Å—è' },
                { name: '–ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–π –∫–∞–ø–∏—Ç–∞–ª (2-–π —Ä–µ–±–µ–Ω–æ–∫)', amount: '833 024 ‚ÇΩ', note: '–° 2020 –≥–æ–¥–∞' }
            ]
        },
        regional: {
            title: 'ü¶å –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤—ã–ø–ª–∞—Ç—ã (–Ø–∫—É—Ç–∏—è)',
            items: [
                { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞–Ω—Å–∫–∏–π –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–π –∫–∞–ø–∏—Ç–∞–ª ¬´–°–µ–º—å—è¬ª', amount: '300 000 ‚ÇΩ', note: '–ù–∞ 3-–≥–æ –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –¥–µ—Ç–µ–π' },
                { name: '–í—ã–ø–ª–∞—Ç–∞ –ø—Ä–∏ —Ä–æ–∂–¥–µ–Ω–∏–∏ (1-—è –∑–æ–Ω–∞)', amount: '55 694 ‚ÇΩ', note: '–†–∞–π–æ–Ω—ã –ö—Ä–∞–π–Ω–µ–≥–æ –°–µ–≤–µ—Ä–∞' },
                { name: '–í—ã–ø–ª–∞—Ç–∞ –ø—Ä–∏ —Ä–æ–∂–¥–µ–Ω–∏–∏ (2-—è –∑–æ–Ω–∞)', amount: '46 650 ‚ÇΩ', note: '–û—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–∞–π–æ–Ω—ã' },
                { name: '–ï–∂–µ–º–µ—Å—è—á–Ω–æ–µ –ø–æ—Å–æ–±–∏–µ –¥–æ 3 –ª–µ—Ç (1-—è –∑–æ–Ω–∞)', amount: '27 847 ‚ÇΩ', note: '–ï–∂–µ–º–µ—Å—è—á–Ω–æ' },
                { name: '–ï–∂–µ–º–µ—Å—è—á–Ω–æ–µ –ø–æ—Å–æ–±–∏–µ –¥–æ 3 –ª–µ—Ç (2-—è –∑–æ–Ω–∞)', amount: '23 325 ‚ÇΩ', note: '–ï–∂–µ–º–µ—Å—è—á–Ω–æ' },
                { name: '–í—ã–ø–ª–∞—Ç–∞ –º–æ–ª–æ–¥–æ–∂–µ–Ω–∞–º –¥–æ 25 –ª–µ—Ç', amount: '50 000 ‚ÇΩ', note: '–ü—Ä–∏ —Ä–æ–∂–¥–µ–Ω–∏–∏ —Ä–µ–±–µ–Ω–∫–∞' }
            ]
        },
        guardians: {
            title: 'üõ°Ô∏è –õ—å–≥–æ—Ç—ã –¥–ª—è –æ–ø–µ–∫—É–Ω–æ–≤',
            items: [
                'üíµ –í–æ–∑–º–µ—â–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Ä–µ–±–µ–Ω–∫–∞ (–µ–∂–µ–º–µ—Å—è—á–Ω–æ)',
                'üìö –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è',
                'üè† –õ—å–≥–æ—Ç—ã –Ω–∞ –ñ–ö–• (–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è 30-50%)',
                'üè° –û—á–µ—Ä–µ–¥–Ω–æ—Å—Ç—å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –∂–∏–ª—å—è',
                'üå≥ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∑–µ–º–µ–ª—å–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏ –º–Ω–æ–≥–æ–¥–µ—Ç–Ω—ã–º'
            ]
        }
    },
    
    documents: {
        title: 'üìã –î–æ–∫—É–º–µ–Ω—Ç—ã',
        required: [
            '–ó–∞—è–≤–ª–µ–Ω–∏–µ –æ–± —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –æ–ø–µ–∫–∏',
            '–ü–∞—Å–ø–æ—Ä—Ç –≥—Ä–∞–∂–¥–∞–Ω–∏–Ω–∞ –†–§',
            '–°–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –æ —Ä–æ–∂–¥–µ–Ω–∏–∏ —Ä–µ–±–µ–Ω–∫–∞ (–∏–ª–∏ –ø–∞—Å–ø–æ—Ä—Ç, –µ—Å–ª–∏ —Å—Ç–∞—Ä—à–µ 14)',
            '–°–ø—Ä–∞–≤–∫–∞ —Å –º–µ—Å—Ç–∞ —Ä–∞–±–æ—Ç—ã –æ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –∏ –∑–∞—Ä–ø–ª–∞—Ç–µ',
            '–°–ø—Ä–∞–≤–∫–∞ –æ —Å–æ—Å—Ç–∞–≤–µ —Å–µ–º—å–∏ (—Ñ–æ—Ä–º–∞ 9)',
            '–°–ø—Ä–∞–≤–∫–∞ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å—É–¥–∏–º–æ—Å—Ç–∏',
            '–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞ (—Ñ–æ—Ä–º–∞ 003-–í/—É)',
            '–°–ø—Ä–∞–≤–∫–∞ –æ–± —É—Å–ª–æ–≤–∏—è—Ö –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è',
            '–ê–∫—Ç –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∂–∏–ª—å—è (—Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –æ—Ä–≥–∞–Ω–æ–º –æ–ø–µ–∫–∏)',
            '–°–æ–≥–ª–∞—Å–∏–µ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏—Ö —á–ª–µ–Ω–æ–≤ —Å–µ–º—å–∏'
        ],
        additional: [
            '–°–ø—Ä–∞–≤–∫–∞ –æ –¥–æ—Ö–æ–¥–∞—Ö (–¥–ª—è –Ω–µ—Ä–∞–±–æ—Ç–∞—é—â–∏—Ö ‚Äî –∏–∑ –¶–ó–ù)',
            '–í—ã–ø–∏—Å–∫–∞ –∏–∑ –ï–ì–†–ù –æ –ø—Ä–∞–≤–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏',
            '–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∂–∏–ª–æ–≥–æ –ø–æ–º–µ—â–µ–Ω–∏—è',
            '–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ —Å –º–µ—Å—Ç–∞ —Ä–∞–±–æ—Ç—ã/—É—á—ë–±—ã',
            '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ –ø—Å–∏—Ö–æ–ª–æ–≥–∞ (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)'
        ],
        deadlines: {
            '–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –∑–∞—è–≤–ª–µ–Ω–∏—è': '–î–æ 2 –º–µ—Å—è—Ü–µ–≤',
            '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ —Å—É–¥': '–î–æ 15 –¥–Ω–µ–π –ø–æ—Å–ª–µ —Ä–µ—à–µ–Ω–∏—è',
            '–°—É–¥–µ–±–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ': '1-2 –º–µ—Å—è—Ü–∞',
            '–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–∞': '–í –¥–µ–Ω—å –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è —Ä–µ—à–µ–Ω–∏—è –≤ —Å–∏–ª—É'
        }
    },
    
    calendar: {
        title: 'üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∏ —Å—Ä–æ–∫–∏',
        reception: {
            title: 'üèõÔ∏è –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –≥—Ä–∞–∂–¥–∞–Ω',
            schedule: [
                { day: '–ü–Ω, –°—Ä, –ü—Ç', time: '—Å 10:00 –¥–æ 16:00' },
                { day: '–í—Ç, –ß—Ç', time: '–ø—Ä–∏—ë–º –ø–æ –∑–∞–ø–∏—Å–∏' },
                { day: '–û–±–µ–¥', time: '13:00-14:00' },
                { day: '–í—ã—Ö–æ–¥–Ω—ã–µ', time: '–°–±, –í—Å' }
            ]
        },
        paymentDeadlines: {
            title: '‚è∞ –°—Ä–æ–∫–∏ –ø–æ–¥–∞—á–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤',
            items: [
                { name: '–ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ –≤—ã–ø–ª–∞—Ç—ã', deadline: '–î–æ 26 —á–∏—Å–ª–∞ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞' },
                { name: '–ï–¥–∏–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ—Å–æ–±–∏—è', deadline: '–í —Ç–µ—á–µ–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤' },
                { name: '–ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–π –∫–∞–ø–∏—Ç–∞–ª', deadline: '–í —Ç–µ—á–µ–Ω–∏–µ –≥–æ–¥–∞' },
                { name: '–ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –ñ–ö–•', deadline: '–†–∞–∑ –≤ –∫–≤–∞—Ä—Ç–∞–ª' }
            ]
        },
        reporting: {
            title: 'üìã –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å',
            items: [
                { period: '–ï–∂–µ–º–µ—Å—è—á–Ω–æ', task: '–û—Ç—á—ë—Ç –æ —Ä–∞—Å—Ö–æ–¥–∞—Ö' },
                { period: '–ö–∞–∂–¥—ã–µ 6 –º–µ—Å.', task: '–û—Ç—á—ë—Ç –æ–± —É—Å–ª–æ–≤–∏—è—Ö –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è' },
                { period: '–ï–∂–µ–≥–æ–¥–Ω–æ', task: '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–æ–≤' },
                { period: '–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö', task: '–°–æ–æ–±—â–∏—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ 1 –º–µ—Å.' }
            ]
        },
        school: {
            title: 'üéì –®–∫–æ–ª—å–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å',
            items: [
                { date: '1 —Å–µ–Ω—Ç—è–±—Ä—è', event: '–ù–∞—á–∞–ª–æ —É—á–µ–±–Ω–æ–≥–æ –≥–æ–¥–∞' },
                { date: '1 –æ–∫—Ç—è–±—Ä—è', event: '–ü–æ–¥–∞—á–∞ –∑–∞—è–≤–ª–µ–Ω–∏–π –Ω–∞ –ø–∏—Ç–∞–Ω–∏–µ' },
                { date: '1 —è–Ω–≤–∞—Ä—è', event: '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª—å–≥–æ—Ç' },
                { date: '–ö–∞–Ω–∏–∫—É–ª—ã', event: '–û—Å–µ–Ω–Ω–∏–µ, –∑–∏–º–Ω–∏–µ, –≤–µ—Å–µ–Ω–Ω–∏–µ' }
            ]
        }
    },
    
    contacts: {
        title: 'üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã',
        emergency: [
            { name: '–ï–¥–∏–Ω—ã–π –Ω–æ–º–µ—Ä —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã—Ö —Å–ª—É–∂–±', phone: '112' },
            { name: '–¢–µ–ª–µ—Ñ–æ–Ω –¥–æ–≤–µ—Ä–∏—è', phone: '8-800-2000-122' },
            { name: '–ì–æ—Ä—è—á–∞—è –ª–∏–Ω–∏—è –¥–ª—è –¥–µ—Ç–µ–π', phone: '8-800-700-54-01' }
        ],
        institutions: [
            { name: '–û—Ç–¥–µ–ª –æ–ø–µ–∫–∏ –∏ –ø–æ–ø–µ—á–∏—Ç–µ–ª—å—Å—Ç–≤–∞', phone: '(41138) 2-22-22', address: '—É–ª. –õ–µ–Ω–∏–Ω–∞, –≥. –û–ª—ë–∫–º–∏–Ω—Å–∫', hours: '–ü–Ω-–ü—Ç 9:00-18:00' },
            { name: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã', phone: '(41138) 2-11-11', address: '–≥. –û–ª—ë–∫–º–∏–Ω—Å–∫', hours: '–ü–Ω-–ü—Ç 9:00-18:00' },
            { name: '–°—É–¥ –û–ª—ë–∫–º–∏–Ω—Å–∫–æ–≥–æ —Ä–∞–π–æ–Ω–∞', phone: '(41138) 2-33-33', address: '—É–ª. –°–æ–≤–µ—Ç—Å–∫–∞—è', hours: '–ü–Ω-–ü—Ç 9:00-18:00' },
            { name: '–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è —é—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –ø–æ–º–æ—â—å', phone: '8-800-2000-116', address: '–±–µ—Å–ø–ª–∞—Ç–Ω–∞—è—é—Ä–∏–¥–∏—á–µ—Å–∫–∞—è–ø–æ–º–æ—â—å.—Ä—Ñ', hours: '–ö—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ' }
        ]
    },
    
    faq: {
        title: '‚ùì FAQ',
        questions: [
            {
                q: '–ö–∞–∫ –æ—Ñ–æ—Ä–º–∏—Ç—å –æ–ø–µ–∫—É–Ω—Å—Ç–≤–æ –Ω–∞–¥ —Ä–µ–±–µ–Ω–∫–æ–º?',
                a: `–ü–æ—Ä—è–¥–æ–∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è:
1Ô∏è‚É£ –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –æ—Ç–¥–µ–ª –æ–ø–µ–∫–∏ –ø–æ –º–µ—Å—Ç—É –∂–∏—Ç–µ–ª—å—Å—Ç–≤–∞ —Ä–µ–±–µ–Ω–∫–∞
2Ô∏è‚É£ –ü–æ–¥–∞–π—Ç–µ –∑–∞—è–≤–ª–µ–Ω–∏–µ –∏ –ø–∞–∫–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
3Ô∏è‚É£ –ü—Ä–æ–π–¥–∏—Ç–µ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∂–∏–ª–∏—â–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
4Ô∏è‚É£ –ü–æ–ª—É—á–∏—Ç–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∞ –æ–ø–µ–∫–∏
5Ô∏è‚É£ –û—Ä–≥–∞–Ω –æ–ø–µ–∫–∏ –ø–æ–¥–∞–µ—Ç –∑–∞—è–≤–ª–µ–Ω–∏–µ –≤ —Å—É–¥
6Ô∏è‚É£ –ü—Ä–∏–º–∏—Ç–µ —É—á–∞—Å—Ç–∏–µ –≤ —Å—É–¥–µ–±–Ω–æ–º –∑–∞—Å–µ–¥–∞–Ω–∏–∏
7Ô∏è‚É£ –ü–æ–ª—É—á–∏—Ç–µ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –ø–æ—Å–ª–µ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è —Ä–µ—à–µ–Ω–∏—è –≤ —Å–∏–ª—É`
            },
            {
                q: '–ö—Ç–æ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –æ–ø–µ–∫—É–Ω–æ–º?',
                a: `–û–ø–µ–∫—É–Ω–æ–º –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –¥–µ–µ—Å–ø–æ—Å–æ–±–Ω–æ–µ –ª–∏—Ü–æ —Å—Ç–∞—Ä—à–µ 18 –ª–µ—Ç, –∫–æ—Ç–æ—Ä–æ–µ:
‚úÖ –ò–º–µ–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –º–µ—Å—Ç–æ –∂–∏—Ç–µ–ª—å—Å—Ç–≤–∞
‚úÖ –û–±–ª–∞–¥–∞–µ—Ç —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ –¥–ª—è —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è —Ä–µ–±–µ–Ω–∫–∞
‚úÖ –ù–µ –∏–º–µ–µ—Ç —Å—É–¥–∏–º–æ—Å—Ç–∏ –∑–∞ —É–º—ã—à–ª–µ–Ω–Ω—ã–µ –ø—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏—è
‚úÖ –ù–µ –ª–∏—à–µ–Ω–æ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∞–≤
‚úÖ –ù–µ –ø—Ä–∏–∑–Ω–∞–Ω–æ –Ω–µ–¥–µ–µ—Å–ø–æ—Å–æ–±–Ω—ã–º
‚úÖ –ò–º–µ–µ—Ç –Ω–∞–¥–ª–µ–∂–∞—â–∏–µ –∂–∏–ª–∏—â–Ω—ã–µ —É—Å–ª–æ–≤–∏—è`
            },
            {
                q: '–ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ –≤ –æ–ø–µ–∫–µ?',
                a: `–ï—Å–ª–∏ –≤–∞–º –æ—Ç–∫–∞–∑–∞–ª–∏:
1Ô∏è‚É£ –ü–æ—Ç—Ä–µ–±—É–π—Ç–µ –ø–∏—Å—å–º–µ–Ω–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –æ—Ç–∫–∞–∑–∞
2Ô∏è‚É£ –£—Å—Ç—Ä–∞–Ω–∏—Ç–µ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
3Ô∏è‚É£ –û–±–∂–∞–ª—É–π—Ç–µ —Ä–µ—à–µ–Ω–∏–µ –≤ –≤—ã—à–µ—Å—Ç–æ—è—â–∏–π –æ—Ä–≥–∞–Ω
4Ô∏è‚É£ –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ —Å—É–¥ —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º –∏—Å–∫–æ–º
5Ô∏è‚É£ –ü–æ–ª—É—á–∏—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—É—é —é—Ä–∏–¥–∏—á–µ—Å–∫—É—é –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –ø–æ ‚òéÔ∏è 8-800-2000-116`
            },
            {
                q: '–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–æ–∂–µ–Ω–Ω—ã–µ –≤—ã–ø–ª–∞—Ç—ã?',
                a: `–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—ã–ø–ª–∞—Ç:
1Ô∏è‚É£ –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã
2Ô∏è‚É£ –ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –æ–± –æ–ø–µ–∫–µ
3Ô∏è‚É£ –ù–∞–ø–∏—à–∏—Ç–µ –∑–∞—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã–ø–ª–∞—Ç
4Ô∏è‚É£ –ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –±–∞–Ω–∫–æ–≤—Å–∫–æ–≥–æ —Å—á–µ—Ç–∞
5Ô∏è‚É£ –ï–∂–µ–≥–æ–¥–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–π—Ç–µ –ø—Ä–∞–≤–æ –Ω–∞ –≤—ã–ø–ª–∞—Ç—ã

üí° –í—ã–ø–ª–∞—Ç—ã –Ω–∞–∑–Ω–∞—á–∞—é—Ç—Å—è —Å–æ –¥–Ω—è –ø–æ–¥–∞—á–∏ –∑–∞—è–≤–ª–µ–Ω–∏—è!`
            },
            {
                q: '–ö–∞–∫–∏–µ –ø—Ä–∞–≤–∞ –∏ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏ –æ–ø–µ–∫—É–Ω–∞?',
                a: `üìã –ü—Ä–∞–≤–∞ –æ–ø–µ–∫—É–Ω–∞:
‚Ä¢ –í–æ—Å–ø–∏—Ç—ã–≤–∞—Ç—å —Ä–µ–±–µ–Ω–∫–∞ –ø–æ —Å–≤–æ–∏–º —É–±–µ–∂–¥–µ–Ω–∏—è–º
‚Ä¢ –ü–æ–ª—É—á–∞—Ç—å –≤—ã–ø–ª–∞—Ç—ã –∏ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏
‚Ä¢ –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å—ã —Ä–µ–±–µ–Ω–∫–∞
‚Ä¢ –£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∏–º—É—â–µ—Å—Ç–≤–æ–º

üìã –û–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏ –æ–ø–µ–∫—É–Ω–∞:
‚Ä¢ –°–æ–¥–µ—Ä–∂–∞—Ç—å –∏ –≤–æ—Å–ø–∏—Ç—ã–≤–∞—Ç—å —Ä–µ–±–µ–Ω–∫–∞
‚Ä¢ –ó–∞–±–æ—Ç–∏—Ç—å—Å—è –æ –∑–¥–æ—Ä–æ–≤—å–µ –∏ —Ä–∞–∑–≤–∏—Ç–∏–∏
‚Ä¢ –ì–æ—Ç–æ–≤–∏—Ç—å –∫ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏
‚Ä¢ –û—Ç—á–∏—Ç—ã–≤–∞—Ç—å—Å—è –ø–µ—Ä–µ–¥ –æ—Ä–≥–∞–Ω–æ–º –æ–ø–µ–∫–∏`
            },
            {
                q: '–ö–∞–∫ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å—Å—è –æ—Ç –æ–ø–µ–∫–∏?',
                a: `–û–ø–µ–∫–∞ –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç—Å—è:
‚Ä¢ –ü–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ä–µ–±–µ–Ω–∫–æ–º 18 –ª–µ—Ç
‚Ä¢ –ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ä–æ–¥–∏—Ç–µ–ª–µ–π –≤ –ø—Ä–∞–≤–∞—Ö
‚Ä¢ –ü—Ä–∏ —É—Å—ã–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ä–µ–±–µ–Ω–∫–∞
‚Ä¢ –ü–æ –∑–∞—è–≤–ª–µ–Ω–∏—é –æ–ø–µ–∫—É–Ω–∞ (–ø–æ —É–≤–∞–∂–∏—Ç–µ–ª—å–Ω—ã–º –ø—Ä–∏—á–∏–Ω–∞–º)
‚Ä¢ –ü—Ä–∏ –ª–∏—à–µ–Ω–∏–∏ –æ–ø–µ–∫—É–Ω–∞ –ø—Ä–∞–≤ –≤ —Å—É–¥–µ–±–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ

–î–ª—è –ø–æ–¥–∞—á–∏ –∑–∞—è–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –æ—Ä–≥–∞–Ω –æ–ø–µ–∫–∏.`
            }
        ]
    },
    
    resources: {
        title: 'üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã',
        laws: [
            'üìú –°–µ–º–µ–π–Ω—ã–π –∫–æ–¥–µ–∫—Å –†–§ (–≥–ª–∞–≤–∞ –æ –∑–∞–º–µ—â–∞—é—â–∏—Ö —Å–µ–º—å—è—Ö)',
            'üìú –§–ó ¬´–û–± –æ–ø–µ–∫–µ –∏ –ø–æ–ø–µ—á–∏—Ç–µ–ª—å—Å—Ç–≤–µ¬ª',
            'üìú –§–ó ¬´–û –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Ä–∞—Ö –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å–µ–º–µ–π —Å –¥–µ—Ç—å–º–∏¬ª',
            'üìú –ó–∞–∫–æ–Ω –†–°(–Ø) ¬´–û –º–µ—Ä–∞—Ö —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å–µ–º–µ–π¬ª'
        ],
        websites: [
            { name: '–ì–æ—Å—É—Å–ª—É–≥–∏', url: 'gosuslugi.ru' },
            { name: '–ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–π –∫–∞–ø–∏—Ç–∞–ª', url: 'mp.gosuslugi.ru' },
            { name: '–ü–æ—Ä—Ç–∞–ª –ø–æ—Å–æ–±–∏–π', url: 'posobie.gosuslugi.ru' },
            { name: '–°–∞–π—Ç –†–°(–Ø)', url: 'sakha.gov.ru' },
            { name: '–û–ª—ë–∫–º–∏–Ω—Å–∫–∏–π —Ä–∞–π–æ–Ω', url: 'olekminsk.ru' },
            { name: '–î–µ—Ç–∏ –Ø–∫—É—Ç–∏–∏', url: 'deti-yakutia.ru' }
        ],
        phones: [
            { name: '–ú–∏–Ω–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –†–°(–Ø)', phone: '(4112) 44-55-66' },
            { name: '–ú–∏–Ω—Ç—Ä—É–¥ –†–°(–Ø)', phone: '(4112) 36-42-34' },
            { name: '–ü–µ–Ω—Å–∏–æ–Ω–Ω—ã–π —Ñ–æ–Ω–¥ –†–§', phone: '8-800-600-44-44' },
            { name: '–†–æ—Å–ø–æ—Ç—Ä–µ–±–Ω–∞–¥–∑–æ—Ä', phone: '8-800-555-49-43' }
        ]
    }
};

// ==========================================
// –ö–õ–ê–í–ò–ê–¢–£–†–´
// ==========================================

const mainKeyboard = {
    reply_markup: {
        keyboard: [
            ['üí∞ –õ—å–≥–æ—Ç—ã –∏ –≤—ã–ø–ª–∞—Ç—ã', 'üìã –î–æ–∫—É–º–µ–Ω—Ç—ã'],
            ['üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã', '‚ùì FAQ'],
            ['üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã', 'üÜò –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –ø–æ–º–æ—â—å']
        ],
        resize_keyboard: true,
        one_time_keyboard: false
    }
};

const paymentsKeyboard = {
    reply_markup: {
        keyboard: [
            ['üá∑üá∫ –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≤—ã–ø–ª–∞—Ç—ã', 'ü¶å –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤—ã–ø–ª–∞—Ç—ã'],
            ['üõ°Ô∏è –õ—å–≥–æ—Ç—ã –¥–ª—è –æ–ø–µ–∫—É–Ω–æ–≤'],
            ['‚óÄÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é']
        ],
        resize_keyboard: true
    }
};

const backKeyboard = {
    reply_markup: {
        keyboard: [
            ['‚óÄÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é']
        ],
        resize_keyboard: true
    }
};

// ==========================================
// –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
// ==========================================

function escapeMarkdown(text) {
    return text.replace(/[_*[\]()~`>#+=|{}.!-]/g, '\\$&');
}

function formatPaymentsFederal() {
    let text = `*${handbookData.payments.federal.title}*\n\n`;
    handbookData.payments.federal.items.forEach(item => {
        text += `‚Ä¢ *${escapeMarkdown(item.name)}*\n`;
        text += `  –°—É–º–º–∞: \`${item.amount}\`\n`;
        text += `  _${escapeMarkdown(item.note)}_\n\n`;
    });
    return text;
}

function formatPaymentsRegional() {
    let text = `*${handbookData.payments.regional.title}*\n\n`;
    handbookData.payments.regional.items.forEach(item => {
        text += `‚Ä¢ *${escapeMarkdown(item.name)}*\n`;
        text += `  –°—É–º–º–∞: \`${item.amount}\`\n`;
        text += `  _${escapeMarkdown(item.note)}_\n\n`;
    });
    return text;
}

function formatGuardianBenefits() {
    let text = `*${handbookData.payments.guardians.title}*\n\n`;
    handbookData.payments.guardians.items.forEach(item => {
        text += `‚úÖ ${escapeMarkdown(item)}\n\n`;
    });
    return text;
}

function formatDocuments() {
    let text = `*üìã –î–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –æ–ø–µ–∫–∏*\n\n`;
    
    text += `*‚ö†Ô∏è –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:*\n`;
    handbookData.documents.required.forEach((doc, i) => {
        text += `${i + 1}. ${escapeMarkdown(doc)}\n`;
    });
    
    text += `\n*üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –º–æ–≥—É—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è:*\n`;
    handbookData.documents.additional.forEach(doc => {
        text += `‚Ä¢ ${escapeMarkdown(doc)}\n`;
    });
    
    text += `\n*‚è∞ –°—Ä–æ–∫–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è:*\n`;
    for (const [key, value] of Object.entries(handbookData.documents.deadlines)) {
        text += `‚Ä¢ ${escapeMarkdown(key)}: _${escapeMarkdown(value)}_\n`;
    }
    
    return text;
}

function formatContacts() {
    let text = `*üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã —É—á—Ä–µ–∂–¥–µ–Ω–∏–π*\n\n`;
    
    text += `*üÜò –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ —Ç–µ–ª–µ—Ñ–æ–Ω—ã:*\n`;
    handbookData.contacts.emergency.forEach(item => {
        text += `‚Ä¢ ${escapeMarkdown(item.name)}: \`${item.phone}\`\n`;
    });
    
    text += `\n*üèõÔ∏è –£—á—Ä–µ–∂–¥–µ–Ω–∏—è:*\n`;
    handbookData.contacts.institutions.forEach(item => {
        text += `\n*${escapeMarkdown(item.name)}*\n`;
        text += `üìû ${item.phone ? `\`${item.phone}\`` : '‚Äî'}\n`;
        text += `üìç ${escapeMarkdown(item.address)}\n`;
        text += `üïê ${escapeMarkdown(item.hours)}\n`;
    });
    
    return text;
}

function formatEmergency() {
    return `*üÜò –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –ø–æ–º–æ—â—å*\n\n` +
           `üìû \`112\` ‚Äî –ï–¥–∏–Ω—ã–π –Ω–æ–º–µ—Ä —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã—Ö —Å–ª—É–∂–±\n` +
           `üìû \`8-800-2000-122\` ‚Äî –¢–µ–ª–µ—Ñ–æ–Ω –¥–æ–≤–µ—Ä–∏—è\n` +
           `üìû \`8-800-700-54-01\` ‚Äî –ì–æ—Ä—è—á–∞—è –ª–∏–Ω–∏—è –¥–ª—è –¥–µ—Ç–µ–π\n` +
           `üìû \`8-800-2000-116\` ‚Äî –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è —é—Ä–ø–æ–º–æ—â—å\n\n` +
           `*–í—Å–µ –∑–≤–æ–Ω–∫–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∏ –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω—ã–µ*\n` +
           `_–ú–æ–∂–Ω–æ –∑–≤–æ–Ω–∏—Ç—å –∞–Ω–æ–Ω–∏–º–Ω–æ_`;
}

function formatFAQList() {
    let text = `*‚ùì –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã*\n\n`;
    text += `–í—ã–±–µ—Ä–∏—Ç–µ –≤–æ–ø—Ä–æ—Å, –Ω–∞–∂–∞–≤ –Ω–∞ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ:\n\n`;
    
    handbookData.faq.questions.forEach((item, i) => {
        text += `${i + 1}. ${escapeMarkdown(item.q)}\n`;
    });
    
    return text;
}

function formatFAQAnswer(index) {
    const item = handbookData.faq.questions[index];
    if (!item) return '–í–æ–ø—Ä–æ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω';
    
    return `*${escapeMarkdown(item.q)}*\n\n${escapeMarkdown(item.a)}`;
}

function formatResources() {
    let text = `*üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã*\n\n`;
    
    text += `*üìú –ó–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ:*\n`;
    handbookData.resources.laws.forEach(law => {
        text += `‚Ä¢ ${escapeMarkdown(law)}\n`;
    });
    
    text += `\n*üåê –°–∞–π—Ç—ã:*\n`;
    handbookData.resources.websites.forEach(site => {
        text += `‚Ä¢ ${escapeMarkdown(site.name)}: ${escapeMarkdown(site.url)}\n`;
    });
    
    text += `\n*üìû –¢–µ–ª–µ—Ñ–æ–Ω—ã:*\n`;
    handbookData.resources.phones.forEach(phone => {
        text += `‚Ä¢ ${escapeMarkdown(phone.name)}: \`${phone.phone}\`\n`;
    });
    
    return text;
}

function createFAQKeyboard() {
    const buttons = handbookData.faq.questions.map((item, i) => [{
        text: `${i + 1}. ${item.q.substring(0, 30)}...`,
        callback_data: `faq_${i}`
    }]);
    
    return {
        reply_markup: {
            inline_keyboard: buttons
        }
    };
}

// ==========================================
// –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –ö–û–ú–ê–ù–î
// ==========================================

// –ö–æ–º–∞–Ω–¥–∞ /start
bot.onText(/\/start/, (msg) => {
    const chatId = msg.chat.id;
    const welcomeText = 
        `üëã *–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!*\n\n` +
        `–≠—Ç–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –±–æ—Ç –¥–ª—è –æ–ø–µ–∫—É–Ω–æ–≤, –ø–æ–ø–µ—á–∏—Ç–µ–ª–µ–π –∏ –ø—Ä–∏–µ–º–Ω—ã—Ö —Ä–æ–¥–∏—Ç–µ–ª–µ–π *–û–ª—ë–∫–º–∏–Ω—Å–∫–æ–≥–æ —Ä–∞–π–æ–Ω–∞*.\n\n` +
        `üì± –ó–¥–µ—Å—å –≤—ã –Ω–∞–π–¥–µ—Ç–µ:\n` +
        `‚Ä¢ üí∞ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ª—å–≥–æ—Ç–∞—Ö –∏ –≤—ã–ø–ª–∞—Ç–∞—Ö\n` +
        `‚Ä¢ üìã –°–ø–∏—Å–æ–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤\n` +
        `‚Ä¢ üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã —É—á—Ä–µ–∂–¥–µ–Ω–∏–π\n` +
        `‚Ä¢ ‚ùì –û—Ç–≤–µ—Ç—ã –Ω–∞ —á–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã\n` +
        `‚Ä¢ üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã\n\n` +
        `–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª –≤ –º–µ–Ω—é –Ω–∏–∂–µ:`;
    
    bot.sendMessage(chatId, welcomeText, {
        parse_mode: 'Markdown',
        ...mainKeyboard
    });
});

// –ö–æ–º–∞–Ω–¥–∞ /help
bot.onText(/\/help/, (msg) => {
    const chatId = msg.chat.id;
    const helpText = 
        `*üìñ –°–ø—Ä–∞–≤–∫–∞ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –±–æ—Ç–∞*\n\n` +
        `*–ö–æ–º–∞–Ω–¥—ã:*\n` +
        `/start ‚Äî –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n` +
        `/help ‚Äî –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É\n` +
        `/payments ‚Äî –õ—å–≥–æ—Ç—ã –∏ –≤—ã–ø–ª–∞—Ç—ã\n` +
        `/documents ‚Äî –î–æ–∫—É–º–µ–Ω—Ç—ã\n` +
        `/contacts ‚Äî –ö–æ–Ω—Ç–∞–∫—Ç—ã\n` +
        `/faq ‚Äî –í–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã\n` +
        `/emergency ‚Äî –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –ø–æ–º–æ—â—å\n\n` +
        `*–ù–∞–≤–∏–≥–∞—Ü–∏—è:*\n` +
        `–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.\n\n` +
        `–ï—Å–ª–∏ —É –≤–∞—Å –æ—Å—Ç–∞–ª–∏—Å—å –≤–æ–ø—Ä–æ—Å—ã, –ø–æ–∑–≤–æ–Ω–∏—Ç–µ –Ω–∞ –≥–æ—Ä—è—á—É—é –ª–∏–Ω–∏—é: üìû 8-800-2000-122`;
    
    bot.sendMessage(chatId, helpText, {
        parse_mode: 'Markdown',
        ...mainKeyboard
    });
});

// –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã
bot.onText(/\/payments/, (msg) => {
    bot.sendMessage(msg.chat.id, '–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –≤—ã–ø–ª–∞—Ç:', paymentsKeyboard);
});

bot.onText(/\/documents/, (msg) => {
    bot.sendMessage(msg.chat.id, formatDocuments(), {
        parse_mode: 'Markdown',
        ...backKeyboard
    });
});

bot.onText(/\/contacts/, (msg) => {
    bot.sendMessage(msg.chat.id, formatContacts(), {
        parse_mode: 'Markdown',
        ...backKeyboard
    });
});

bot.onText(/\/faq/, (msg) => {
    bot.sendMessage(msg.chat.id, formatFAQList(), {
        parse_mode: 'Markdown',
        ...createFAQKeyboard()
    });
});

bot.onText(/\/emergency/, (msg) => {
    bot.sendMessage(msg.chat.id, formatEmergency(), {
        parse_mode: 'Markdown',
        ...backKeyboard
    });
});

// ==========================================
// –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–û–ë–©–ï–ù–ò–ô
// ==========================================

bot.on('message', (msg) => {
    const chatId = msg.chat.id;
    const text = msg.text;
    
    // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –∫–æ–º–∞–Ω–¥—ã
    if (text && text.startsWith('/')) return;
    
    switch(text) {
        case 'üí∞ –õ—å–≥–æ—Ç—ã –∏ –≤—ã–ø–ª–∞—Ç—ã':
            bot.sendMessage(chatId, '–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –≤—ã–ø–ª–∞—Ç:', paymentsKeyboard);
            break;
            
        case 'üá∑üá∫ –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –≤—ã–ø–ª–∞—Ç—ã':
            bot.sendMessage(chatId, formatPaymentsFederal(), {
                parse_mode: 'Markdown',
                ...paymentsKeyboard
            });
            break;
            
        case 'ü¶å –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤—ã–ø–ª–∞—Ç—ã':
            bot.sendMessage(chatId, formatPaymentsRegional(), {
                parse_mode: 'Markdown',
                ...paymentsKeyboard
            });
            break;
            
        case 'üõ°Ô∏è –õ—å–≥–æ—Ç—ã –¥–ª—è –æ–ø–µ–∫—É–Ω–æ–≤':
            bot.sendMessage(chatId, formatGuardianBenefits(), {
                parse_mode: 'Markdown',
                ...paymentsKeyboard
            });
            break;
            
        case 'üìã –î–æ–∫—É–º–µ–Ω—Ç—ã':
            bot.sendMessage(chatId, formatDocuments(), {
                parse_mode: 'Markdown',
                ...backKeyboard
            });
            break;
            
        case 'üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã':
            bot.sendMessage(chatId, formatContacts(), {
                parse_mode: 'Markdown',
                ...backKeyboard
            });
            break;
            
        case '‚ùì FAQ':
            bot.sendMessage(chatId, formatFAQList(), {
                parse_mode: 'Markdown',
                ...createFAQKeyboard()
            });
            break;
            
        case 'üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã':
            bot.sendMessage(chatId, formatResources(), {
                parse_mode: 'Markdown',
                ...backKeyboard
            });
            break;
            
        case 'üÜò –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –ø–æ–º–æ—â—å':
            bot.sendMessage(chatId, formatEmergency(), {
                parse_mode: 'Markdown',
                ...backKeyboard
            });
            break;
            
        case '‚óÄÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é':
            bot.sendMessage(chatId, '–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:', mainKeyboard);
            break;
    }
});

// ==========================================
// –û–ë–†–ê–ë–û–¢–ß–ò–ö INLINE-–ö–ù–û–ü–û–ö
// ==========================================

bot.on('callback_query', (query) => {
    const chatId = query.message.chat.id;
    const data = query.data;
    
    if (data.startsWith('faq_')) {
        const index = parseInt(data.split('_')[1]);
        const answer = formatFAQAnswer(index);
        
        bot.answerCallbackQuery(query.id);
        bot.sendMessage(chatId, answer, {
            parse_mode: 'Markdown',
            reply_markup: {
                inline_keyboard: [[
                    { text: '‚óÄÔ∏è –ö —Å–ø–∏—Å–∫—É –≤–æ–ø—Ä–æ—Å–æ–≤', callback_data: 'faq_list' }
                ]]
            }
        });
    }
    
    if (data === 'faq_list') {
        bot.answerCallbackQuery(query.id);
        bot.sendMessage(chatId, formatFAQList(), {
            parse_mode: 'Markdown',
            ...createFAQKeyboard()
        });
    }
});

// ==========================================
// –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö
// ==========================================

bot.on('polling_error', (error) => {
    console.error('Polling error:', error);
});

bot.on('error', (error) => {
    console.error('Bot error:', error);
});

// ==========================================
// –ó–ê–ü–£–°–ö
// ==========================================

console.log('ü§ñ –ë–æ—Ç "–ü–∞–º—è—Ç–∫–∞ –¥–ª—è –æ–ø–µ–∫—É–Ω–æ–≤" –∑–∞–ø—É—â–µ–Ω!');
console.log('üìç –û–ª—ë–∫–º–∏–Ω—Å–∫–∏–π —Ä–∞–π–æ–Ω, –†–µ—Å–ø—É–±–ª–∏–∫–∞ –°–∞—Ö–∞ (–Ø–∫—É—Ç–∏—è)');
console.log('');
console.log('–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:');
console.log('  /start - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É');
console.log('  /help - –°–ø—Ä–∞–≤–∫–∞');
console.log('  /payments - –õ—å–≥–æ—Ç—ã –∏ –≤—ã–ø–ª–∞—Ç—ã');
console.log('  /documents - –î–æ–∫—É–º–µ–Ω—Ç—ã');
console.log('  /contacts - –ö–æ–Ω—Ç–∞–∫—Ç—ã');
console.log('  /faq - –í–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã');
console.log('  /emergency - –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –ø–æ–º–æ—â—å');
